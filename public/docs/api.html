<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API æ–‡æ¡£ - è®¾å¤‡é€‚é…å™¨</title>
  <style>
    :root {
      --primary: #6366f1;
      --bg-dark: #0f172a;
      --bg-card: #1e293b;
      --text-primary: #f8fafc;
      --text-secondary: #94a3b8;
      --border-color: #334155;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
    }
    
    h1 { color: var(--primary); margin-bottom: 10px; }
    h2 { color: var(--primary); margin: 30px 0 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
    h3 { color: var(--text-primary); margin: 20px 0 10px; }
    
    .subtitle { color: var(--text-secondary); margin-bottom: 30px; }
    
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .endpoint {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .method {
      padding: 4px 10px;
      border-radius: 4px;
      font-weight: bold;
      font-size: 12px;
    }
    
    .method.get { background: var(--success); color: white; }
    .method.post { background: var(--primary); color: white; }
    .method.put { background: var(--warning); color: white; }
    .method.delete { background: var(--danger); color: white; }
    
    .path {
      font-family: 'Consolas', monospace;
      font-size: 14px;
      color: var(--text-primary);
    }
    
    .description { color: var(--text-secondary); margin-bottom: 15px; }
    
    pre {
      background: #0d1117;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 15px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
    }
    
    code {
      font-family: 'Consolas', 'Monaco', monospace;
      color: #e6db74;
    }
    
    .param-table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
    }
    
    .param-table th, .param-table td {
      text-align: left;
      padding: 8px 12px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .param-table th {
      color: var(--text-secondary);
      font-weight: 500;
    }
    
    .required { color: var(--danger); }
    .optional { color: var(--text-secondary); }
    
    .event-list { list-style: none; }
    .event-list li { padding: 5px 0; }
    .event-id { 
      font-family: monospace; 
      background: var(--bg-dark); 
      padding: 2px 6px; 
      border-radius: 4px;
      color: var(--primary);
    }
    
    .developer {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-top: 30px;
      padding: 20px;
      background: var(--bg-card);
      border-radius: 8px;
    }
    
    .developer img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
    }
    
    .developer a {
      color: var(--primary);
      text-decoration: none;
    }
    
    .developer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ® è®¾å¤‡é€‚é…å™¨ API æ–‡æ¡£</h1>
    <p class="subtitle">DG-LAB & å½¹æ¬¡å…ƒ ç»Ÿä¸€æ§åˆ¶æ¥å£ v1.0</p>
    
    <h2>ğŸ“¡ API åŸºç¡€ä¿¡æ¯</h2>
    <div class="card">
      <p><strong>åŸºç¡€ URL:</strong> <code>http://localhost:3000/api</code></p>
      <p><strong>WebSocket:</strong> <code>ws://localhost:3000</code></p>
      <p><strong>å†…å®¹ç±»å‹:</strong> <code>application/json</code></p>
    </div>
    
    <h2>ğŸ”Œ è®¾å¤‡ç®¡ç† API</h2>
    
    <div class="card">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="path">/api/devices</span>
      </div>
      <p class="description">è·å–æ‰€æœ‰å·²æ³¨å†Œè®¾å¤‡åˆ—è¡¨</p>
      <h4>å“åº”ç¤ºä¾‹:</h4>
      <pre><code>{
  "success": true,
  "data": [{
    "id": "device_1",
    "name": "æˆ‘çš„éƒŠç‹¼",
    "type": "dglab",
    "status": "connected",
    "isVirtual": false
  }]
}</code></pre>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/devices</span>
      </div>
      <p class="description">æ·»åŠ æ–°è®¾å¤‡</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>type</td><td>string</td><td class="required">æ˜¯</td><td>"dglab" æˆ– "yokonex"</td></tr>
        <tr><td>name</td><td>string</td><td class="optional">å¦</td><td>è®¾å¤‡åç§°</td></tr>
        <tr><td>config</td><td>object</td><td class="required">æ˜¯</td><td>è¿æ¥é…ç½®</td></tr>
        <tr><td>config.isVirtual</td><td>boolean</td><td class="optional">å¦</td><td>æ˜¯å¦ä¸ºè™šæ‹Ÿæµ‹è¯•è®¾å¤‡</td></tr>
      </table>
      <h4>è¯·æ±‚ç¤ºä¾‹:</h4>
      <pre><code>{
  "type": "dglab",
  "name": "æˆ‘çš„éƒŠç‹¼",
  "config": {
    "websocketUrl": "ws://192.168.1.100:9999",
    "connectionType": "websocket"
  }
}</code></pre>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/devices/:id/connect</span>
      </div>
      <p class="description">è¿æ¥æŒ‡å®šè®¾å¤‡</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/devices/:id/disconnect</span>
      </div>
      <p class="description">æ–­å¼€æŒ‡å®šè®¾å¤‡è¿æ¥</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method delete">DELETE</span>
        <span class="path">/api/devices/:id</span>
      </div>
      <p class="description">åˆ é™¤æŒ‡å®šè®¾å¤‡</p>
    </div>
    
    <h2>ğŸ›ï¸ è®¾å¤‡æ§åˆ¶ API</h2>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/control/strength</span>
      </div>
      <p class="description">è®¾ç½®è®¾å¤‡å¼ºåº¦</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>deviceId</td><td>string</td><td class="required">æ˜¯</td><td>è®¾å¤‡ID</td></tr>
        <tr><td>channel</td><td>string</td><td class="required">æ˜¯</td><td>"A", "B", æˆ– "AB"</td></tr>
        <tr><td>value</td><td>number</td><td class="required">æ˜¯</td><td>å¼ºåº¦å€¼ (0-200 éƒŠç‹¼, 0-276 å½¹æ¬¡å…ƒ)</td></tr>
        <tr><td>mode</td><td>string</td><td class="optional">å¦</td><td>"set", "increase", æˆ– "decrease"</td></tr>
      </table>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/control/waveform</span>
      </div>
      <p class="description">å‘é€æ³¢å½¢æ•°æ® (ä»… DG-LAB)</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>deviceId</td><td>string</td><td class="required">æ˜¯</td><td>è®¾å¤‡ID</td></tr>
        <tr><td>channel</td><td>string</td><td class="required">æ˜¯</td><td>"A" æˆ– "B"</td></tr>
        <tr><td>waveform</td><td>object</td><td class="required">æ˜¯</td><td>æ³¢å½¢æ•°æ®</td></tr>
      </table>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/control/event</span>
      </div>
      <p class="description">å‘é€äº‹ä»¶åˆ°è®¾å¤‡</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>deviceId</td><td>string</td><td class="optional">å¦</td><td>è®¾å¤‡ID (ä¸å¡«åˆ™å‘é€åˆ°æ‰€æœ‰è®¾å¤‡)</td></tr>
        <tr><td>eventId</td><td>string</td><td class="required">æ˜¯</td><td>äº‹ä»¶ID</td></tr>
        <tr><td>payload</td><td>object</td><td class="optional">å¦</td><td>äº‹ä»¶æ•°æ®</td></tr>
      </table>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/control/stop</span>
      </div>
      <p class="description">ç´§æ€¥åœæ­¢æ‰€æœ‰è®¾å¤‡ (å¼ºåº¦å½’é›¶)</p>
    </div>
    
    <h2>ğŸ“… äº‹ä»¶ç®¡ç† API</h2>
    
    <div class="card">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="path">/api/events</span>
      </div>
      <p class="description">è·å–æ‰€æœ‰å·²æ³¨å†Œäº‹ä»¶</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/events</span>
      </div>
      <p class="description">åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>eventId</td><td>string</td><td class="required">æ˜¯</td><td>äº‹ä»¶å”¯ä¸€æ ‡è¯†</td></tr>
        <tr><td>name</td><td>string</td><td class="required">æ˜¯</td><td>äº‹ä»¶åç§°</td></tr>
        <tr><td>description</td><td>string</td><td class="optional">å¦</td><td>äº‹ä»¶æè¿°</td></tr>
        <tr><td>channel</td><td>string</td><td class="optional">å¦</td><td>"A", "B", æˆ– "AB"</td></tr>
        <tr><td>action</td><td>string</td><td class="optional">å¦</td><td>"set", "pulse", "increase", "decrease"</td></tr>
        <tr><td>value</td><td>number</td><td class="optional">å¦</td><td>å¼ºåº¦å€¼</td></tr>
        <tr><td>duration</td><td>number</td><td class="optional">å¦</td><td>è„‰å†²æŒç»­æ—¶é—´(ms)</td></tr>
      </table>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method put">PUT</span>
        <span class="path">/api/events/:id</span>
      </div>
      <p class="description">æ›´æ–°äº‹ä»¶é…ç½®</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method delete">DELETE</span>
        <span class="path">/api/events/:id</span>
      </div>
      <p class="description">åˆ é™¤äº‹ä»¶</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/events/:id/trigger</span>
      </div>
      <p class="description">è§¦å‘æŒ‡å®šäº‹ä»¶</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>deviceId</td><td>string</td><td class="optional">å¦</td><td>ç›®æ ‡è®¾å¤‡ID</td></tr>
        <tr><td>multiplier</td><td>number</td><td class="optional">å¦</td><td>å¼ºåº¦å€ç‡</td></tr>
      </table>
    </div>
    
    <h2>ğŸ¯ å¿…å¤‡äº‹ä»¶æ¶æ„</h2>
    <div class="card">
      <p class="description">æ¸¸æˆé€‚é…å™¨åº”å‘é€ä»¥ä¸‹æ ‡å‡†äº‹ä»¶IDæ¥è§¦å‘è®¾å¤‡åŠ¨ä½œï¼š</p>
      <ul class="event-list">
        <li><span class="event-id">lost-ahp</span> - æŠ¤ç”²è¡€é‡å‡å°‘äº‹ä»¶</li>
        <li><span class="event-id">lost-hp</span> - è§’è‰²è¡€é‡å‡å°‘äº‹ä»¶ (æ ¸å¿ƒ)</li>
        <li><span class="event-id">add-ahp</span> - æŠ¤ç”²è¡€é‡æ¢å¤äº‹ä»¶</li>
        <li><span class="event-id">add-hp</span> - è§’è‰²è¡€é‡æ¢å¤äº‹ä»¶</li>
        <li><span class="event-id">character-debuff</span> - è§’è‰²Debuffäº‹ä»¶ (ä¸­æ¯’ã€ç‡ƒçƒ§ç­‰)</li>
        <li><span class="event-id">query</span> - è§’è‰²è¡€é‡ä¸ŠæŠ¥ (çŠ¶æ€åŒæ­¥)</li>
        <li><span class="event-id">dead</span> - è§’è‰²æ­»äº¡äº‹ä»¶ (æœ€é«˜ä¼˜å…ˆçº§)</li>
        <li><span class="event-id">new-credit</span> - å…³å¡é‡ç½®äº‹ä»¶ (å¤æ´»/æ–°å…³å¡)</li>
      </ul>
    </div>
    
    <h2>ğŸ“œ è„šæœ¬ç®¡ç† API</h2>
    
    <div class="card">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="path">/api/scripts</span>
      </div>
      <p class="description">è·å–æ‰€æœ‰è„šæœ¬</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/scripts</span>
      </div>
      <p class="description">åˆ›å»ºè„šæœ¬</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/scripts/:id/start</span>
      </div>
      <p class="description">å¯åŠ¨è„šæœ¬</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/scripts/:id/stop</span>
      </div>
      <p class="description">åœæ­¢è„šæœ¬</p>
    </div>
    
    <h2>âš™ï¸ ç³»ç»Ÿè®¾ç½® API</h2>
    
    <div class="card">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="path">/api/settings</span>
      </div>
      <p class="description">è·å–ç³»ç»Ÿè®¾ç½®</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method put">PUT</span>
        <span class="path">/api/settings</span>
      </div>
      <p class="description">æ›´æ–°ç³»ç»Ÿè®¾ç½®</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method get">GET</span>
        <span class="path">/api/settings/export/all</span>
      </div>
      <p class="description">å¯¼å‡ºæ‰€æœ‰æ•°æ® (JSONæ ¼å¼å¤‡ä»½)</p>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/settings/import</span>
      </div>
      <p class="description">å¯¼å…¥æ•°æ®</p>
      <h4>è¯·æ±‚å‚æ•°:</h4>
      <table class="param-table">
        <tr><th>å‚æ•°</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr>
        <tr><td>data</td><td>object</td><td class="required">æ˜¯</td><td>å¤‡ä»½æ•°æ®</td></tr>
        <tr><td>options.merge</td><td>boolean</td><td class="optional">å¦</td><td>æ˜¯å¦åˆå¹¶ (é»˜è®¤è¦†ç›–)</td></tr>
      </table>
    </div>
    
    <div class="card">
      <div class="endpoint">
        <span class="method post">POST</span>
        <span class="path">/api/settings/reset</span>
      </div>
      <p class="description">é‡ç½®æ‰€æœ‰æ•°æ®ä¸ºé»˜è®¤å€¼</p>
    </div>
    
    <h2>ğŸ”— WebSocket äº‹ä»¶</h2>
    <div class="card">
      <p class="description">è¿æ¥ WebSocket åå¯è®¢é˜…ä»¥ä¸‹äº‹ä»¶ï¼š</p>
      <h4>è®¢é˜…æ¶ˆæ¯:</h4>
      <pre><code>{
  "type": "subscribe",
  "events": ["device:status", "device:feedback", "device:strength"]
}</code></pre>
      <h4>æ¥æ”¶äº‹ä»¶:</h4>
      <ul class="event-list">
        <li><span class="event-id">device:status</span> - è®¾å¤‡è¿æ¥çŠ¶æ€å˜åŒ–</li>
        <li><span class="event-id">device:strength</span> - è®¾å¤‡å¼ºåº¦å˜åŒ–</li>
        <li><span class="event-id">device:feedback</span> - è®¾å¤‡åé¦ˆæ¶ˆæ¯</li>
        <li><span class="event-id">device:connected</span> - è®¾å¤‡å·²è¿æ¥</li>
        <li><span class="event-id">device:disconnected</span> - è®¾å¤‡å·²æ–­å¼€</li>
      </ul>
    </div>
    
    <h2>ğŸ‘¨â€ğŸ’» å¼€å‘è€…</h2>
    <div class="developer">
      <img src="https://github.com/yomo40.png" alt="yomo40" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%236366f1%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2260%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2240%22>Y</text></svg>'">
      <div>
        <strong>yomo40</strong>
        <p>GitHub: <a href="https://github.com/yomo40" target="_blank">https://github.com/yomo40</a></p>
      </div>
    </div>
    
    <p style="margin-top: 40px; text-align: center; color: var(--text-secondary);">
      &copy; 2025 Device Adapter Project | MIT License
    </p>
  </div>
</body>
</html>
