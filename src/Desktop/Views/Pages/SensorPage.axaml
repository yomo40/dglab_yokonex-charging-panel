<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="ChargingPanel.Desktop.Views.Pages.SensorPage">
    
    <Grid RowDefinitions="Auto,*,Auto">
        <!-- æ ‡é¢˜æ  -->
        <Border Grid.Row="0" Padding="20" CornerRadius="16" Margin="0,0,0,16" BoxShadow="0 4 16 0 #10000000">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                    <GradientStop Offset="0" Color="#313244" />
                    <GradientStop Offset="1" Color="#353550" />
                </LinearGradientBrush>
            </Border.Background>
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Border Background="#06b6d420" CornerRadius="10" Padding="10">
                        <TextBlock Text="ðŸ“¡" FontSize="20" VerticalAlignment="Center" />
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="ä¼ æ„Ÿå™¨é…ç½®" FontSize="18" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="é…ç½®å½¹æ¬¡å…ƒä¼ æ„Ÿå™¨çš„è§¦å‘è§„åˆ™" FontSize="12" Foreground="#A6ADC8" Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>
                <Button Grid.Column="1" Click="OnScanSensors" Padding="16,10" CornerRadius="10" FontWeight="SemiBold">
                    <Button.Background>
                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                            <GradientStop Offset="0" Color="#06b6d4" />
                            <GradientStop Offset="1" Color="#22d3ee" />
                        </LinearGradientBrush>
                    </Button.Background>
                    <TextBlock Text="æ‰«æä¼ æ„Ÿå™¨" Foreground="White" />
                </Button>
            </Grid>
        </Border>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <Grid Grid.Row="1" ColumnDefinitions="300,*" Margin="0">
            <!-- å·¦ä¾§ï¼šä¼ æ„Ÿå™¨åˆ—è¡¨ -->
            <Border CornerRadius="16" Padding="16" BoxShadow="0 4 16 0 #10000000">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Offset="0" Color="#313244" />
                        <GradientStop Offset="1" Color="#353550" />
                    </LinearGradientBrush>
                </Border.Background>
                <Grid RowDefinitions="Auto,*">
                    <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,16">
                        <Border Background="#10B98120" CornerRadius="8" Padding="8">
                            <TextBlock Text="ðŸ“±" FontSize="14" VerticalAlignment="Center" />
                        </Border>
                        <TextBlock Text="å·²è¿žæŽ¥ä¼ æ„Ÿå™¨" FontWeight="Bold" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <ListBox Grid.Row="1" x:Name="SensorList" Background="Transparent"
                             SelectionChanged="OnSensorSelected">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#3C3C3C" CornerRadius="6" Padding="12" Margin="0,4">
                                    <Grid RowDefinitions="Auto,Auto,Auto">
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="10" Height="10" Fill="{Binding StatusColor}" Margin="0,0,8,0"/>
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold" Foreground="White"/>
                                        </StackPanel>
                                        <TextBlock Grid.Row="1" Text="{Binding TypeName}" FontSize="11" Foreground="#888" Margin="18,4,0,0"/>
                                        <TextBlock Grid.Row="2" Text="{Binding StatusText}" FontSize="11" Foreground="#666" Margin="18,2,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>
            
            <!-- å³ä¾§ï¼šé…ç½®é¢æ¿ -->
            <ScrollViewer Grid.Column="1" Margin="16,0,0,0">
                <Grid>
                    <StackPanel x:Name="ConfigPanel" IsVisible="False">
                        <!-- ä¼ æ„Ÿå™¨ä¿¡æ¯ -->
                        <Border CornerRadius="16" Padding="18" Margin="0,0,0,16" BoxShadow="0 4 16 0 #10000000">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Offset="0" Color="#313244" />
                                    <GradientStop Offset="1" Color="#353550" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid RowDefinitions="Auto,Auto,Auto,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,12">
                                    <Border Background="#8b5cf620" CornerRadius="8" Padding="8">
                                        <TextBlock Text="â„¹ï¸" FontSize="14" VerticalAlignment="Center" />
                                    </Border>
                                    <TextBlock Text="ä¼ æ„Ÿå™¨ä¿¡æ¯" FontWeight="Bold" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <Grid Grid.Row="1" ColumnDefinitions="100,*" Margin="0,8,0,0">
                                    <TextBlock Text="åç§°:" Foreground="#A6ADC8"/>
                                    <TextBox Grid.Column="1" x:Name="SensorNameInput" Background="#1E1E2E" Foreground="White" CornerRadius="8" Padding="10,8"/>
                                </Grid>
                                
                                <Grid Grid.Row="2" ColumnDefinitions="100,*" Margin="0,8,0,0">
                                    <TextBlock Text="ç±»åž‹:" Foreground="#A6ADC8"/>
                                    <TextBlock Grid.Column="1" x:Name="SensorTypeText" Foreground="White"/>
                                </Grid>
                                
                                <Grid Grid.Row="3" ColumnDefinitions="100,*" Margin="0,8,0,0">
                                    <TextBlock Text="çŠ¶æ€:" Foreground="#A6ADC8"/>
                                    <TextBlock Grid.Column="1" x:Name="SensorStatusText" Foreground="#10B981"/>
                                </Grid>
                            </Grid>
                        </Border>
                        
                        <!-- å®žæ—¶æ•°æ® -->
                        <Border CornerRadius="16" Padding="18" Margin="0,0,0,16" BoxShadow="0 4 16 0 #10000000">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Offset="0" Color="#313244" />
                                    <GradientStop Offset="1" Color="#353550" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid RowDefinitions="Auto,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,12">
                                    <Border Background="#10B98120" CornerRadius="8" Padding="8">
                                        <TextBlock Text="ðŸ“Š" FontSize="14" VerticalAlignment="Center" />
                                    </Border>
                                    <TextBlock Text="å®žæ—¶æ•°æ®" FontWeight="Bold" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <Grid Grid.Row="1" ColumnDefinitions="*,*" Margin="0,8,0,0">
                                    <!-- å½¹æ¬¡å…ƒä¼ æ„Ÿå™¨æ•°æ® -->
                                    <StackPanel x:Name="YokonexSensorData">
                                        <TextBlock Text="æ­¥æ•°" Foreground="#A6ADC8" FontSize="11"/>
                                        <Border Background="#3B82F6" CornerRadius="8" Padding="12,6" Margin="0,6,0,0" HorizontalAlignment="Left">
                                            <TextBlock x:Name="StepCountText" Text="0" Foreground="White" FontSize="18" FontWeight="Bold"/>
                                        </Border>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" x:Name="AngleData">
                                        <TextBlock Text="è§’åº¦" Foreground="#A6ADC8" FontSize="11"/>
                                        <Border Background="#3B82F6" CornerRadius="8" Padding="12,6" Margin="0,6,0,0" HorizontalAlignment="Left">
                                            <TextBlock x:Name="AngleText" Text="X:0Â° Y:0Â° Z:0Â°" Foreground="White" FontSize="16" FontWeight="Bold"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </Border>
                        
                        <!-- è§¦å‘è§„åˆ™ -->
                        <Border CornerRadius="16" Padding="18" Margin="0,0,0,16" BoxShadow="0 4 16 0 #10000000">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Offset="0" Color="#313244" />
                                    <GradientStop Offset="1" Color="#353550" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid RowDefinitions="Auto,Auto,*">
                                <Grid ColumnDefinitions="*,Auto">
                                    <StackPanel Orientation="Horizontal" Spacing="10">
                                        <Border Background="#F59E0B20" CornerRadius="8" Padding="8">
                                            <TextBlock Text="âš¡" FontSize="14" VerticalAlignment="Center" />
                                        </Border>
                                        <TextBlock Text="è§¦å‘è§„åˆ™" FontWeight="Bold" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Button Grid.Column="1" Click="OnAddRule" Padding="14,8" CornerRadius="10" FontWeight="SemiBold">
                                        <Button.Background>
                                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                <GradientStop Offset="0" Color="#8b5cf6" />
                                                <GradientStop Offset="1" Color="#a855f7" />
                                            </LinearGradientBrush>
                                        </Button.Background>
                                        <TextBlock Text="+ æ·»åŠ è§„åˆ™" Foreground="White" />
                                    </Button>
                                </Grid>
                                
                                <TextBlock Grid.Row="1" Text="é…ç½®ä¼ æ„Ÿå™¨äº‹ä»¶è§¦å‘çš„è®¾å¤‡åŠ¨ä½œ" Foreground="#A6ADC8" FontSize="11" Margin="0,8,0,12"/>
                                
                                <ItemsControl Grid.Row="2" x:Name="RulesList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#3C3C3C" CornerRadius="6" Padding="12" Margin="0,4">
                                                <Grid ColumnDefinitions="*,Auto">
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding TriggerTypeName}" FontWeight="SemiBold" Foreground="White"/>
                                                        <TextBlock Text="{Binding ActionDescription}" FontSize="11" Foreground="#888" Margin="0,4,0,0"/>
                                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                            <TextBlock Text="ç›®æ ‡è®¾å¤‡: " FontSize="11" Foreground="#666"/>
                                                            <TextBlock Text="{Binding TargetDeviceName}" FontSize="11" Foreground="#0078D4"/>
                                                        </StackPanel>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                                                        <ToggleSwitch IsChecked="{Binding IsEnabled}" OnContent="å¯ç”¨" OffContent="ç¦ç”¨"
                                                                      IsCheckedChanged="OnRuleToggleChanged"/>
                                                        <Button Background="Transparent" Foreground="#EF4444"
                                                                Padding="8,4" CornerRadius="4"
                                                                Click="OnDeleteRule" Tag="{Binding}">
                                                            <TextBlock Text="ðŸ—‘ï¸" FontSize="14" />
                                                        </Button>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </Border>
                        
                        <!-- å…³è”è®¾å¤‡ -->
                        <Border CornerRadius="16" Padding="18" BoxShadow="0 4 16 0 #10000000">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Offset="0" Color="#313244" />
                                    <GradientStop Offset="1" Color="#353550" />
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid RowDefinitions="Auto,Auto,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Border Background="#06b6d420" CornerRadius="8" Padding="8">
                                        <TextBlock Text="ðŸ”—" FontSize="14" VerticalAlignment="Center" />
                                    </Border>
                                    <TextBlock Text="å…³è”ç”µå‡»å™¨" FontWeight="Bold" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Grid.Row="1" Text="é€‰æ‹©ä¼ æ„Ÿå™¨è§¦å‘æ—¶æŽ§åˆ¶çš„ç”µå‡»å™¨è®¾å¤‡" Foreground="#A6ADC8" FontSize="11" Margin="0,8,0,12"/>
                                
                                <ComboBox Grid.Row="2" x:Name="TargetDeviceCombo" Background="#1E1E2E" Foreground="White"
                                          SelectionChanged="OnTargetDeviceChanged" HorizontalAlignment="Stretch" CornerRadius="10">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </Grid>
                        </Border>
                    </StackPanel>
                    
                    <!-- æœªé€‰æ‹©ä¼ æ„Ÿå™¨æ—¶çš„æç¤º -->
                    <Border x:Name="NoSelectionPanel" CornerRadius="16" Padding="40" 
                            HorizontalAlignment="Center" VerticalAlignment="Center" BoxShadow="0 4 16 0 #10000000">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                <GradientStop Offset="0" Color="#313244" />
                                <GradientStop Offset="1" Color="#353550" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <StackPanel HorizontalAlignment="Center">
                            <Border Background="#06b6d420" CornerRadius="20" Width="80" Height="80" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“¡" FontSize="40" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="è¯·ä»Žå·¦ä¾§é€‰æ‹©ä¸€ä¸ªä¼ æ„Ÿå™¨" Foreground="#A6ADC8" FontSize="14" Margin="0,20,0,0" HorizontalAlignment="Center"/>
                            <TextBlock Text="æˆ–ç‚¹å‡»[æ‰«æä¼ æ„Ÿå™¨]æœç´¢æ–°è®¾å¤‡" Foreground="#6B7280" FontSize="12" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </ScrollViewer>
        </Grid>
        
        <!-- åº•éƒ¨çŠ¶æ€æ  -->
        <Border Grid.Row="2" Padding="16,12" CornerRadius="16" Margin="0,16,0,0">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                    <GradientStop Offset="0" Color="#8b5cf6" />
                    <GradientStop Offset="1" Color="#a855f7" />
                </LinearGradientBrush>
            </Border.Background>
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock x:Name="StatusText" Text="å°±ç»ª" Foreground="White" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="ä¼ æ„Ÿå™¨: " Foreground="#E0E0E0"/>
                    <TextBlock x:Name="SensorCountText" Text="0" Foreground="White" FontWeight="Bold"/>
                    <TextBlock Text=" | è§„åˆ™: " Foreground="#E0E0E0" Margin="16,0,0,0"/>
                    <TextBlock x:Name="RuleCountText" Text="0" Foreground="White" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
    
</UserControl>
